Index: app/src/main/java/com/example/walktoshop/Seller/SellerViewAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.walktoshop.Seller;\r\n\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.ArrayAdapter;\r\nimport android.widget.Button;\r\nimport android.widget.CalendarView;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\n\r\nimport com.example.walktoshop.R;\r\nimport com.example.walktoshop.Seller.Business;\r\nimport com.example.walktoshop.User.CardView;\r\nimport com.example.walktoshop.User.UserView;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.OnFailureListener;\r\nimport com.google.android.gms.tasks.OnSuccessListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.android.material.button.MaterialButton;\r\nimport com.google.firebase.firestore.DocumentReference;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FieldValue;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.gson.Gson;\r\n\r\nimport java.lang.reflect.Field;\r\nimport java.util.ArrayList;\r\nimport java.util.Calendar;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\n\r\npublic class SellerViewAdapter extends ArrayAdapter {\r\n    private Context context;\r\n    private ArrayList<Discount> discounts;\r\n    private String UID;\r\n    private ArrayList<String> businessUID;\r\n    private String usage;\r\n    FirebaseFirestore db =FirebaseFirestore.getInstance();\r\n\r\n    public SellerViewAdapter(Context context, ArrayList<Discount> discounts, String UID,ArrayList businessUID,String usage) {\r\n        super(context, R.layout.activity_sellerviewadapter);\r\n        this.context=context;\r\n        this.discounts=discounts;\r\n        this.UID = UID;\r\n        this.usage= usage;\r\n        this.businessUID = businessUID;\r\n\r\n    }\r\n    @Override\r\n    public int getCount() {\r\n        return discounts.size();\r\n    }\r\n    @Override\r\n    public Object getItem(int position) {\r\n        return discounts.get(position);\r\n    }\r\n\r\n    @Override\r\n    public long getItemId(int position) {\r\n        return position;\r\n    }\r\n    @Override\r\n    public int getViewTypeCount() {\r\n        if(getCount() > 0){\r\n            return getCount();\r\n        }else{\r\n            return super.getViewTypeCount();\r\n        }\r\n    }\r\n    @Override\r\n    public int getItemViewType(int position) {\r\n        return position;\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public View getView(int position, @Nullable View convertView, @NonNull ViewGroup parent) {\r\n        LayoutInflater layoutInflater=(LayoutInflater) context.getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);\r\n        final View activity = layoutInflater.inflate(R.layout.activity_sellerviewadapter,parent,false);\r\n        //caratteristiche card di sconto\r\n        TextView disocuntDescription= activity.findViewById(R.id.disocuntDescription);\r\n        TextView date = activity.findViewById(R.id.date);\r\n        //bottone eliminazione\r\n        ImageButton deleteDiscount =activity.findViewById(R.id.deleteDiscount);\r\n        //modifica\r\n        ImageButton editDiscount = activity.findViewById(R.id.editDiscount);\r\n        TextView difficulty = activity.findViewById(R.id.difficulty);\r\n        ImageView difficultyColor = activity.findViewById(R.id.difficultyColor);\r\n        ImageButton arrow = (ImageButton) activity.findViewById(R.id.arrow);\r\n        Button addDiscount = (Button) activity.findViewById(R.id.addButton);\r\n\r\n        //bottone attivazione contapassi\r\n        //bottone abilitazione\r\n        if(this.discounts.get(position) != null && position>=0 && !discounts.isEmpty()){\r\n            Discount d=this.discounts.get(position);\r\n            //settare tutti gli attributi xml\r\n            Log.d(\"DATE\", d.millisecondsToDate(d.getExpiringDate()));\r\n            date.setText(\"scadenza: \"+d.millisecondsToDate(d.getExpiringDate()));\r\n            disocuntDescription.setText(d.getDescription());\r\n            String stringedGoal=d.getDiscountsQuantity();\r\n            Log.d(\"string\",stringedGoal+\"\");\r\n\r\n            if(stringedGoal != null){\r\n                int goal= Integer.parseInt(stringedGoal);\r\n\r\n                if(goal<5000){\r\n                    difficulty.setText(\"Facile\");\r\n\r\n                }else if(goal>=5000 && goal<=20000){\r\n                    difficulty.setText(\"Difficoltà Media\");\r\n                    difficultyColor.setImageResource(R.drawable.ic_yellow);\r\n                }else if(goal>20000){\r\n                    difficulty.setText(\"Difficile\");\r\n                    difficultyColor.setImageResource(R.drawable.ic_red);\r\n                }\r\n            }\r\n            //visibility\r\n            deleteDiscount.setVisibility(View.GONE);\r\n            editDiscount.setVisibility(View.GONE);\r\n            if(this.usage==\"sellerHome\"){\r\n                arrow.setVisibility(View.GONE);\r\n                addDiscount.setVisibility(View.GONE);\r\n                deleteDiscount.setVisibility(View.VISIBLE);\r\n                editDiscount.setVisibility(View.VISIBLE);\r\n                if(Long.parseLong(d.getExpiringDate()) < Calendar.getInstance().getTimeInMillis()){\r\n                    date.setText(\"Scaduto\");\r\n                }\r\n                deleteDiscount.setOnClickListener(new View.OnClickListener() {\r\n                    @Override\r\n                    public void onClick(View v) {\r\n                        //Log.d(\"p\",discounts.get(position).getUID()+\" \");\r\n                        getBusiness(position);\r\n                    }\r\n                });\r\n            }else if(this.usage==\"userHome\"){\r\n                arrow.setVisibility(View.VISIBLE);\r\n                addDiscount.setVisibility(View.GONE);\r\n\r\n                if(Long.parseLong(d.getExpiringDate()) < Calendar.getInstance().getTimeInMillis()){\r\n                    arrow.setVisibility(View.GONE);\r\n                    date.setText(\"Scaduto\");\r\n                }\r\n                arrow.setOnClickListener(new View.OnClickListener() {\r\n                    @Override\r\n                    public void onClick(View v) {\r\n                        final Intent intent = new Intent(getContext(), CardView.class);\r\n                        Gson gson = new Gson();\r\n                        String jsonDiscount = gson.toJson(d);\r\n                        intent.putExtra(\"discount\",jsonDiscount);\r\n                        Log.d(\"json\",jsonDiscount);\r\n                        intent.putExtra(\"UID\",UID);\r\n                        context.startActivity(intent);\r\n                    }\r\n                });\r\n                //qui si devono inserire elementi grafici tipici della vista in cui è chiamato\r\n            }else if(this.usage==\"backdropList\"){\r\n                arrow.setVisibility(View.GONE);\r\n                addDiscount.setVisibility(View.VISIBLE);\r\n                if(Long.parseLong(d.getExpiringDate()) < Calendar.getInstance().getTimeInMillis()){\r\n                    date.setText(\"Scaduto\");\r\n                }\r\n                addDiscount.setOnClickListener(new View.OnClickListener() {\r\n                    @Override\r\n                    public void onClick(View view) {\r\n                        addDiscounts(d.getUID());\r\n                    }\r\n                });\r\n                //qui si devono inserire elementi grafici tipici della vista in cui è chiamato\r\n            }\r\n        }\r\n        return activity;\r\n    }\r\n\r\n    private void deleteDiscount(int position){\r\n        //getBusiness(position);\r\n        db.collection(\"sconti\").document(discounts.get(position).getUID())\r\n                .delete()\r\n                .addOnSuccessListener(new OnSuccessListener<Void>() {\r\n                    @Override\r\n                    public void onSuccess(Void aVoid) {\r\n                        Log.d(\"delete\", \"DocumentSnapshot successfully deleted!\");\r\n                    }\r\n                })\r\n                .addOnFailureListener(new OnFailureListener() {\r\n                    @Override\r\n                    public void onFailure(@NonNull Exception e) {\r\n                        Log.w(\"delete\", \"Error deleting document\", e);\r\n                    }\r\n                }).addOnCompleteListener(new OnCompleteListener<Void>() {\r\n            @Override\r\n            public void onComplete(@NonNull Task<Void> task) {\r\n                SellerViewAdapter.this.discounts.remove(position);\r\n                SellerViewAdapter.this.notifyDataSetChanged();\r\n            }\r\n        });\r\n    }\r\n\r\n    private void getBusiness(int position)\r\n    {\r\n        db.collection(\"attivita\").document(businessUID.get(0)).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n            @Override\r\n            public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                if(task.isSuccessful())\r\n                {   Log.d(\"position\",position+\" \");\r\n                    DocumentSnapshot document = task.getResult();\r\n                    ArrayList<String> discountUID = (ArrayList<String>) document.get(\"discountUID\");\r\n                    discountUID.remove(position);\r\n                    Log.d(\"discountUID\", discountUID.size()+\" \");\r\n                    updateBusiness(discountUID,position);\r\n                }else{\r\n                    Log.d(\"non successo\",\"non successo\");\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    private void updateBusiness(ArrayList<String> discountUID,int position)\r\n    {\r\n        db.collection(\"attivita\").document(businessUID.get(0)).update(\"discountUID\",discountUID).addOnCompleteListener(new OnCompleteListener<Void>() {\r\n            @Override\r\n            public void onComplete(@NonNull Task<Void> task) {\r\n                if(task.isSuccessful())\r\n                {\r\n                    deleteDiscount(position);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    //query di aggiunta sconto\r\n    private void addDiscounts(String discountuid){\r\n        db.collection(\"utente\").document(UID).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n            @Override\r\n            public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                if(task.isSuccessful()){\r\n                    DocumentSnapshot document=task.getResult();\r\n                    ArrayList<String> discountUID= (ArrayList<String>) document.get(\"discountUID\");\r\n                    if(discountUID==null){\r\n                        discountUID=new ArrayList<>();\r\n                    }\r\n                    discountUID.add(discountuid);\r\n                    updateUserDiscounts(discountUID);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    private void updateUserDiscounts(ArrayList<String> discountUID){\r\n        db.collection(\"utente\").document(UID).update(\"discountUID\",discountUID);\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/walktoshop/Seller/SellerViewAdapter.java	(revision 2d78a7e88b389737403e9628653fe3742669a12b)
+++ app/src/main/java/com/example/walktoshop/Seller/SellerViewAdapter.java	(date 1612179788245)
@@ -92,7 +92,6 @@
         //bottone eliminazione
         ImageButton deleteDiscount =activity.findViewById(R.id.deleteDiscount);
         //modifica
-        ImageButton editDiscount = activity.findViewById(R.id.editDiscount);
         TextView difficulty = activity.findViewById(R.id.difficulty);
         ImageView difficultyColor = activity.findViewById(R.id.difficultyColor);
         ImageButton arrow = (ImageButton) activity.findViewById(R.id.arrow);
@@ -125,12 +124,10 @@
             }
             //visibility
             deleteDiscount.setVisibility(View.GONE);
-            editDiscount.setVisibility(View.GONE);
             if(this.usage=="sellerHome"){
                 arrow.setVisibility(View.GONE);
                 addDiscount.setVisibility(View.GONE);
                 deleteDiscount.setVisibility(View.VISIBLE);
-                editDiscount.setVisibility(View.VISIBLE);
                 if(Long.parseLong(d.getExpiringDate()) < Calendar.getInstance().getTimeInMillis()){
                     date.setText("Scaduto");
                 }
@@ -165,9 +162,6 @@
             }else if(this.usage=="backdropList"){
                 arrow.setVisibility(View.GONE);
                 addDiscount.setVisibility(View.VISIBLE);
-                if(Long.parseLong(d.getExpiringDate()) < Calendar.getInstance().getTimeInMillis()){
-                    date.setText("Scaduto");
-                }
                 addDiscount.setOnClickListener(new View.OnClickListener() {
                     @Override
                     public void onClick(View view) {
Index: app/src/main/java/com/example/walktoshop/User/FragmentUserMapBackDrop.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.walktoshop.User;\r\n\r\nimport android.app.ActivityManager;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.AdapterView;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.ListView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.coordinatorlayout.widget.CoordinatorLayout;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.example.walktoshop.R;\r\nimport com.example.walktoshop.Seller.Discount;\r\nimport com.example.walktoshop.Seller.SellerView;\r\nimport com.example.walktoshop.Seller.SellerViewAdapter;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.android.material.bottomsheet.BottomSheetBehavior;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.QueryDocumentSnapshot;\r\nimport com.google.firebase.firestore.QuerySnapshot;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class FragmentUserMapBackDrop extends Fragment {\r\n\r\n    BottomSheetBehavior sheetBehavior;\r\n    FirebaseFirestore db= FirebaseFirestore.getInstance();\r\n    private ListView backdropListview;\r\n    private ArrayList<Discount> discountArray= new ArrayList<>();\r\n    private ArrayList<String> businessUID=new ArrayList<>();\r\n    private String UID;\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\r\n\r\n        View coordinatorLayout = (CoordinatorLayout)inflater.inflate(R.layout.fragment_map_backdrop, container, false);\r\n        backdropListview = coordinatorLayout.findViewById(R.id.backdropListView);\r\n       /* backdropListview.setOnItemClickListener(new AdapterView.OnItemClickListener() {\r\n            @Override\r\n            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {\r\n                final Intent intent = new Intent(getActivity(), CardView.class);\r\n                startActivity(intent);\r\n            }\r\n        });*/\r\n        ImageView filterIcon = coordinatorLayout.findViewById(R.id.filterIcon);\r\n        LinearLayout contentLayout = coordinatorLayout.findViewById(R.id.contentLayout);\r\n        //vengono prese le informazioni passate cliccando sul marker\r\n        Bundle bundle = this.getArguments();\r\n        if (bundle != null) {\r\n            businessUID.add(bundle.getString(\"businessUID\"));\r\n            this.UID=bundle.getString(\"UID\");\r\n            getUserDiscount();\r\n        }\r\n        sheetBehavior = BottomSheetBehavior.from(contentLayout);\r\n        sheetBehavior.setFitToContents(false);\r\n        sheetBehavior.setHideable(false);//evita che il backdrop sia completamente oscurato\r\n        sheetBehavior.setState(BottomSheetBehavior.STATE_EXPANDED);//inizialmente il  backdrop parte esteso\r\n\r\n        filterIcon.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                toggleFilters();\r\n            }\r\n        });\r\n        return coordinatorLayout;\r\n    }\r\n\r\n\r\n    private void getUserDiscount() {\r\n        db.collection(\"utente\").document(UID).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n            @Override\r\n            public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                if(task.isSuccessful()){\r\n                    DocumentSnapshot document = task.getResult();\r\n                    ArrayList<String> userDisUID = (ArrayList<String>) document.get(\"discountUID\");\r\n                    if (userDisUID!= null){\r\n                        getBusiness(userDisUID);\r\n                    } else{\r\n                        final SellerViewAdapter adapter=new SellerViewAdapter(getContext(),discountArray, UID,businessUID,\"backdropList\");\r\n                        backdropListview.setAdapter(adapter);\r\n                    }\r\n                    Log.d(\"disUID\", String.valueOf(userDisUID));\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    private void getBusiness(ArrayList<String> userDisUID) {\r\n        db.collection(\"attivita\").document(businessUID.get(0)).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n            @Override\r\n            public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                if(task.isSuccessful())\r\n                {\r\n                    DocumentSnapshot document = task.getResult();\r\n                    ArrayList<String> discountUID = (ArrayList<String>) document.get(\"discountUID\");\r\n                    Log.d(\"disBusiness\", String.valueOf(discountUID));\r\n                    if(discountUID!=null){\r\n                        Log.d(\"discount\",discountUID.size()+\" \");\r\n                        Log.d(\"business\",businessUID.get(0));\r\n                        if(!discountUID.isEmpty()){\r\n                            getDiscounts(discountUID, userDisUID);\r\n                        }else{\r\n                            final SellerViewAdapter adapter=new SellerViewAdapter(getContext(),discountArray, UID,businessUID,\"backdropList\");\r\n                            backdropListview.setAdapter(adapter);\r\n                        }\r\n                    }\r\n                }else{\r\n                    Log.d(\"non successo\",\"non successo\");\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    private void getDiscounts(ArrayList<String> discountUID, ArrayList<String> userDisUID){\r\n        ArrayList<String> disUID = new ArrayList<String>();\r\n        for(int i=0;i<discountUID.size();i++){\r\n            if(!userDisUID.contains(discountUID.get(i))){\r\n                disUID.add(discountUID.get(i));\r\n            }\r\n        }\r\n        for(int k=0;k<disUID.size();k++){\r\n            Log.d(\"dis\",disUID.get(k).toString());\r\n            db.collection(\"sconti\").document(disUID.get(k)).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n                @Override\r\n                public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                    if(task.isSuccessful()){\r\n                        Discount discount=new Discount();\r\n                        DocumentSnapshot document=task.getResult();\r\n                        discount.setUID(document.getString(\"uid\"));\r\n                        discount.setBusinessUID(document.getString(\"businessUID\"));\r\n                        discount.setState(document.getString(\"state\"));\r\n                        discount.setExpiringDate(document.getString(\"expiringDate\"));\r\n                        discount.setStepNumber(document.getString(\"stepNumber\"));\r\n                        discount.setDescription(document.getString(\"description\"));\r\n                        discount.setDiscountsQuantity(document.getString(\"discountsQuantity\"));\r\n                        discountArray.add(discount);\r\n\r\n                    }\r\n                }\r\n            }).addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n                @Override\r\n                public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                    final SellerViewAdapter adapter=new SellerViewAdapter(getContext(),discountArray, UID,businessUID,\"backdropList\");\r\n                    backdropListview.setAdapter(adapter);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n\r\n\r\n    private void toggleFilters() {\r\n        if (sheetBehavior.getState() == BottomSheetBehavior.STATE_EXPANDED) {\r\n            sheetBehavior.setHideable(true);\r\n            sheetBehavior.setState(BottomSheetBehavior.STATE_HIDDEN);\r\n        } else {\r\n            sheetBehavior.setHideable(true);\r\n            sheetBehavior.setState(BottomSheetBehavior.STATE_HIDDEN);\r\n        }\r\n    }\r\n    //killa il service se attivo\r\n    @Override\r\n    public void onDestroy() {\r\n        super.onDestroy();\r\n        killServiceIfRunning();\r\n    }\r\n    private boolean isMyServiceRunning(Class<?> serviceClass) {\r\n        ActivityManager manager = (ActivityManager) getActivity().getSystemService(Context.ACTIVITY_SERVICE);\r\n        for (ActivityManager.RunningServiceInfo service : manager.getRunningServices(Integer.MAX_VALUE)) {\r\n            if (serviceClass.getName().equals(service.service.getClassName())) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    private void killServiceIfRunning(){\r\n        if(isMyServiceRunning(StepCounter.class) == true){\r\n            Intent intent =new Intent(getActivity(),StepCounter.class);\r\n            Toast.makeText(getActivity(),\"Contapassi disattivato\",Toast.LENGTH_SHORT).show();\r\n            getActivity().stopService(intent);\r\n        }\r\n    }\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/walktoshop/User/FragmentUserMapBackDrop.java	(revision 2d78a7e88b389737403e9628653fe3742669a12b)
+++ app/src/main/java/com/example/walktoshop/User/FragmentUserMapBackDrop.java	(date 1612179597656)
@@ -32,6 +32,7 @@
 import com.google.firebase.firestore.QuerySnapshot;
 
 import java.util.ArrayList;
+import java.util.Calendar;
 import java.util.List;
 
 public class FragmentUserMapBackDrop extends Fragment {
@@ -48,13 +49,7 @@
 
         View coordinatorLayout = (CoordinatorLayout)inflater.inflate(R.layout.fragment_map_backdrop, container, false);
         backdropListview = coordinatorLayout.findViewById(R.id.backdropListView);
-       /* backdropListview.setOnItemClickListener(new AdapterView.OnItemClickListener() {
-            @Override
-            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
-                final Intent intent = new Intent(getActivity(), CardView.class);
-                startActivity(intent);
-            }
-        });*/
+
         ImageView filterIcon = coordinatorLayout.findViewById(R.id.filterIcon);
         LinearLayout contentLayout = coordinatorLayout.findViewById(R.id.contentLayout);
         //vengono prese le informazioni passate cliccando sul marker
@@ -67,7 +62,7 @@
         sheetBehavior = BottomSheetBehavior.from(contentLayout);
         sheetBehavior.setFitToContents(false);
         sheetBehavior.setHideable(false);//evita che il backdrop sia completamente oscurato
-        sheetBehavior.setState(BottomSheetBehavior.STATE_EXPANDED);//inizialmente il  backdrop parte esteso
+        sheetBehavior.setState(BottomSheetBehavior.STATE_HALF_EXPANDED);//inizialmente il  backdrop parte esteso
 
         filterIcon.setOnClickListener(new View.OnClickListener() {
             @Override
@@ -126,6 +121,7 @@
 
     private void getDiscounts(ArrayList<String> discountUID, ArrayList<String> userDisUID){
         ArrayList<String> disUID = new ArrayList<String>();
+
         for(int i=0;i<discountUID.size();i++){
             if(!userDisUID.contains(discountUID.get(i))){
                 disUID.add(discountUID.get(i));
@@ -146,8 +142,9 @@
                         discount.setStepNumber(document.getString("stepNumber"));
                         discount.setDescription(document.getString("description"));
                         discount.setDiscountsQuantity(document.getString("discountsQuantity"));
-                        discountArray.add(discount);
-
+                        if(Long.parseLong(discount.getExpiringDate()) > Calendar.getInstance().getTimeInMillis()){
+                            discountArray.add(discount);
+                        }
                     }
                 }
             }).addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
@@ -160,8 +157,6 @@
         }
     }
 
-
-
     private void toggleFilters() {
         if (sheetBehavior.getState() == BottomSheetBehavior.STATE_EXPANDED) {
             sheetBehavior.setHideable(true);
Index: app/src/main/java/com/example/walktoshop/User/UserView.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.walktoshop.User;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.appcompat.widget.Toolbar;\r\nimport androidx.coordinatorlayout.widget.CoordinatorLayout;\r\nimport androidx.core.app.ActivityCompat;\r\nimport android.Manifest;\r\nimport android.app.ActivityManager;\r\nimport android.app.AlertDialog;\r\nimport android.app.NotificationChannel;\r\nimport android.app.NotificationManager;\r\nimport android.content.Context;\r\nimport android.content.DialogInterface;\r\nimport android.content.Intent;\r\nimport android.content.SharedPreferences;\r\nimport android.content.pm.PackageManager;\r\nimport android.graphics.Color;\r\nimport android.location.Address;\r\nimport android.location.Geocoder;\r\nimport android.location.Location;\r\nimport android.location.LocationListener;\r\nimport android.location.LocationManager;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport android.preference.PreferenceManager;\r\nimport android.provider.Settings;\r\nimport android.util.Log;\r\nimport android.view.Menu;\r\nimport android.view.MenuItem;\r\nimport android.view.View;\r\nimport android.widget.ImageView;\r\nimport android.widget.ListView;\r\nimport android.widget.Space;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.example.walktoshop.Login_SignUp.LogIn;\r\nimport com.example.walktoshop.NetworkController.NetworkController;\r\nimport com.example.walktoshop.R;\r\nimport com.example.walktoshop.Seller.Discount;\r\nimport com.example.walktoshop.Seller.SellerViewAdapter;\r\nimport com.google.android.gms.location.FusedLocationProviderClient;\r\nimport com.google.android.gms.location.LocationServices;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.OnSuccessListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.android.material.appbar.CollapsingToolbarLayout;\r\nimport com.google.android.material.behavior.HideBottomViewOnScrollBehavior;\r\nimport com.google.android.material.bottomnavigation.BottomNavigationView;\r\nimport com.google.android.material.floatingactionbutton.FloatingActionButton;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;;\r\n\r\nimport java.io.IOException;\r\nimport java.util.ArrayList;\r\nimport java.util.Iterator;\r\nimport java.util.List;\r\n\r\n\r\npublic class UserView extends AppCompatActivity {\r\n    FirebaseFirestore db =FirebaseFirestore.getInstance();\r\n    private TextView alert;\r\n    private ListView homeListview;\r\n    private static final String CHANNEL_ID=\"StepCounter_notification_channel\";\r\n    private String userUID=null;\r\n    double latitude=0;\r\n    double longitude=0;\r\n    FloatingActionButton stepcounterFab;\r\n    ImageView userImage;\r\n    boolean isScrolled = false;\r\n    String city=null;\r\n    LocationManager service;\r\n    LocationListener locationListener;\r\n    FusedLocationProviderClient fusedLocationClient;\r\n    private ArrayList<Discount> myDiscounts= new ArrayList<>();\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_user_view);\r\n        fusedLocationClient = LocationServices.getFusedLocationProviderClient(this);\r\n        alert=findViewById(R.id.alert);\r\n        alert.setVisibility(View.GONE);\r\n        stepcounterFab = (FloatingActionButton) findViewById(R.id.stepcounterFab);\r\n        stepcounterFab.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                startStepCounter();\r\n            }\r\n        });\r\n        BottomNavigationView bottomNavigationView = (BottomNavigationView) findViewById(R.id.bottom_navigation);\r\n        homeListview= findViewById(R.id.homeListView);\r\n        //setting del channel per quando partirà il service\r\n        CoordinatorLayout coordinatorLayout = (CoordinatorLayout) findViewById(R.id.userCoordinatorLayout);\r\n        coordinatorLayout.setOnLongClickListener(new View.OnLongClickListener() {\r\n            @Override\r\n            public boolean onLongClick(View v) {\r\n                if(isScrolled == false){\r\n                    bottomNavigationView.setVisibility(View.GONE);\r\n                    isScrolled = true;\r\n                } else {\r\n                    bottomNavigationView.setVisibility(View.VISIBLE);\r\n                    isScrolled = false;\r\n                }\r\n                return false;\r\n            }\r\n        });\r\n        localizeUser();\r\n        createNotificationChannel();\r\n        bottomNavigationView.setOnNavigationItemSelectedListener(new BottomNavigationView.OnNavigationItemSelectedListener() {\r\n            @Override\r\n            public boolean onNavigationItemSelected(@NonNull MenuItem item) {\r\n                switch (item.getItemId()) {\r\n                    case R.id.action_map:\r\n                        if(city==null && latitude==0 && longitude==0){\r\n                            Toast.makeText(UserView.this,\"Rilevamento della posizione in corso\",Toast.LENGTH_SHORT).show();\r\n                            askGPSpermission();\r\n                        }else{\r\n                            goToUserViewMap();\r\n                        }\r\n                        break;\r\n                    case R.id.action_statistics:\r\n                        goUserStatistics();\r\n                        break;\r\n                }\r\n                return true;\r\n            }\r\n        });\r\n        Intent intent =getIntent();\r\n        if(intent.hasExtra(\"UID\")){\r\n            this.userUID = intent.getStringExtra(\"UID\");\r\n        }\r\n    }\r\n    private void localizeUser(){\r\n        if(ActivityCompat.checkSelfPermission(UserView.this, Manifest.permission.ACCESS_FINE_LOCATION) == PackageManager.PERMISSION_GRANTED){\r\n            Task<Location> task = fusedLocationClient.getLastLocation();\r\n            task.addOnSuccessListener(new OnSuccessListener<Location>() {\r\n                @Override\r\n                public void onSuccess(Location location) {\r\n                    if(location != null){\r\n                        longitude = location.getLongitude();\r\n                        latitude = location.getLatitude();\r\n                        Log.d(\"longlat\",longitude+\"-\"+latitude);\r\n                        Geocoder geocoder=new Geocoder(UserView.this);\r\n                        List<Address> addresses=new ArrayList<>();\r\n                        try {\r\n                            addresses=geocoder.getFromLocation(latitude,longitude,1);\r\n                        } catch (IOException e) {\r\n                            e.printStackTrace();\r\n                        }\r\n                        city=addresses.get(0).getLocality();\r\n                        Log.d(\"city\",city);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n\r\n            ActivityCompat.requestPermissions(UserView.this, new String[]{Manifest.permission.ACCESS_FINE_LOCATION}, 44);\r\n        }\r\n    }\r\n\r\n    private void goUserStatistics() {\r\n        final Intent intent = new Intent(UserView.this, UserStatistics.class);\r\n        intent.putExtra(\"UID\", this.userUID);\r\n        intent.putExtra(\"city\",city);\r\n        intent.putExtra(\"latitude\",latitude);\r\n        intent.putExtra(\"longitude\",longitude);\r\n        startActivity(intent);\r\n    }\r\n\r\n    @Override\r\n    protected void onStart() {\r\n        super.onStart();\r\n        NetworkController networkController =new NetworkController();\r\n        if(!networkController.isConnected(UserView.this)){\r\n            networkController.connectionDialog(UserView.this);\r\n        }\r\n        getUserDiscounts();\r\n    }\r\n\r\n    private void getUserDiscounts(){\r\n        db.collection(\"utente\").document(userUID).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n            @Override\r\n            public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                if(task.isSuccessful()){\r\n                    DocumentSnapshot document= task.getResult();\r\n                    ArrayList<String> discountUID = (ArrayList) document.get(\"discountUID\");\r\n                    if(discountUID!=null){\r\n                        getMyDiscounts(discountUID);\r\n                    }else  if(discountUID==null){\r\n                        alert.setVisibility(View.VISIBLE);\r\n                        alert.setText(\"Nessuno sconto attivato\");\r\n                    }else if(discountUID.isEmpty()){\r\n                        alert.setVisibility(View.VISIBLE);\r\n                        alert.setText(\"Nessuno sconto attivato\");\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n    private void getMyDiscounts(ArrayList discountUID){\r\n        if(!discountUID.isEmpty()){\r\n            Iterator it =discountUID.iterator();\r\n            while(it.hasNext()){\r\n                String uid= (String) it.next();\r\n                myDiscounts.clear();\r\n                db.collection(\"sconti\").document(uid).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n                    @Override\r\n                    public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                        if(task.isSuccessful()){\r\n                            DocumentSnapshot document= task.getResult();\r\n                            Discount discount=new Discount();\r\n                            discount.setUID(document.getString(\"uid\"));\r\n                            discount.setExpiringDate(document.getString(\"expiringDate\"));\r\n                            discount.setBusinessUID(document.getString(\"businessUID\"));\r\n                            discount.setDiscountsQuantity(document.getString(\"discountsQuantity\"));\r\n                            discount.setStartDiscountDate(document.getString(\"startDiscountDate\"));\r\n                            discount.setState(document.getString(\"state\"));\r\n                            discount.setDescription(document.getString(\"description\"));\r\n                            discount.setStepNumber(document.getString(\"stepNumber\"));\r\n                            myDiscounts.add(discount);\r\n                        }\r\n                    }\r\n                }).addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n                    @Override\r\n                    public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                        final SellerViewAdapter adapter=new SellerViewAdapter(UserView.this,myDiscounts, userUID,null,\"userHome\");\r\n                        homeListview.setAdapter(adapter);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private void goToUserViewMap() {\r\n        final Intent intent = new Intent(UserView.this, UserMapView.class);\r\n        intent.putExtra(\"UID\", this.userUID);\r\n        intent.putExtra(\"city\",city);\r\n        intent.putExtra(\"latitude\",latitude);\r\n        intent.putExtra(\"longitude\",longitude);\r\n        startActivity(intent);\r\n    }\r\n\r\n    public boolean onCreateOptionsMenu(Menu menu){\r\n        getMenuInflater().inflate(R.menu.menu_action_bar, menu);\r\n        return true;\r\n    }\r\n\r\n    public boolean onOptionsItemSelected(MenuItem item){\r\n        return super.onOptionsItemSelected(item);\r\n    }\r\n    private  void startStepCounter(){\r\n        if(userUID!=null  ){\r\n            Intent intent =new Intent(this,StepCounter.class);\r\n            if(isMyServiceRunning(StepCounter.class) == false){\r\n                Toast.makeText(this,\"Contapassi attivato\",Toast.LENGTH_SHORT).show();\r\n                intent.putExtra(\"UID\",userUID);\r\n                startService(intent);\r\n            }else{\r\n                Toast.makeText(this,\"Contapassi disattivato\",Toast.LENGTH_SHORT).show();\r\n                stopService(intent);\r\n            }\r\n        }\r\n    }\r\n    public void OnItemSelected(MenuItem item) {\r\n       if(item.getItemId() == R.id.action_exit){\r\n           logOut();\r\n       }\r\n    }\r\n\r\n    private void logOut(){\r\n        FirebaseAuth.getInstance().signOut();\r\n        final Intent intent = new Intent(this, LogIn.class);\r\n        startActivity(intent);\r\n        finish();\r\n    }\r\n    private void createNotificationChannel(){\r\n        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.O) {\r\n            NotificationChannel serviceChannel = new NotificationChannel(\r\n                    CHANNEL_ID,\r\n                    \"StepCounter_notification_channel\",\r\n                    NotificationManager.IMPORTANCE_DEFAULT);\r\n            NotificationManager manager =getSystemService(NotificationManager.class);\r\n            manager.createNotificationChannel(serviceChannel);\r\n        }\r\n    }\r\n\r\n    private void killServiceIfRunning(){\r\n        if(isMyServiceRunning(StepCounter.class) == true){\r\n            Intent intent =new Intent(this,StepCounter.class);\r\n            Toast.makeText(this,\"Contapassi disattivato\",Toast.LENGTH_SHORT).show();\r\n            stopService(intent);\r\n        }\r\n    }\r\n    private boolean isMyServiceRunning(Class<?> serviceClass) {\r\n        ActivityManager manager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);\r\n        for (ActivityManager.RunningServiceInfo service : manager.getRunningServices(Integer.MAX_VALUE)) {\r\n            if (serviceClass.getName().equals(service.service.getClassName())) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    @Override\r\n    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\r\n        if(requestCode == 44){\r\n            if(grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED){\r\n\r\n            }\r\n        }else if(requestCode==10){\r\n            if(grantResults.length>0 && grantResults[0]==PackageManager.PERMISSION_GRANTED){\r\n            }else if(grantResults[0]==PackageManager.PERMISSION_DENIED){\r\n                if(ActivityCompat.shouldShowRequestPermissionRationale(UserView.this,Manifest.permission.ACCESS_FINE_LOCATION)){\r\n                    //dialog in cui spiego\r\n                    new AlertDialog.Builder(UserView.this)\r\n                            .setTitle(\"Permission\")\r\n                            .setMessage(\"Denying permission you can't use geo-localization\")\r\n                            .setNeutralButton(\"ok\",null)\r\n                            .show();\r\n                }\r\n            }\r\n        }\r\n    }\r\n    //debug mode\r\n    private void getUserPosition() {\r\n        service = (LocationManager) getSystemService(LOCATION_SERVICE);\r\n        locationListener = new LocationListener() {\r\n            @Override\r\n            public void onLocationChanged(@NonNull Location location) {\r\n                latitude=location.getLatitude();\r\n                longitude=location.getLongitude();\r\n                Log.d(\"coordinates\",latitude+\"\\n\"+longitude);\r\n                try {\r\n                    Geocoder geocoder=new Geocoder(UserView.this);\r\n                    List<Address> addresses=new ArrayList<>();\r\n                    addresses=geocoder.getFromLocation(latitude,longitude,1);\r\n                    String country=addresses.get(0).getCountryName();\r\n                    city=addresses.get(0).getLocality();\r\n                    goToUserViewMap();\r\n                    //Log.d(\"city\",city);\r\n                } catch (IOException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }\r\n\r\n            @Override\r\n            public void onProviderEnabled(@NonNull String provider) {\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onProviderDisabled(@NonNull String provider) {\r\n                new AlertDialog.Builder(UserView.this).setTitle(\"GPS dialog\").setMessage(\"Do you want to turn on gps?\")\r\n                        .setPositiveButton(\"Yes\", new DialogInterface.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(DialogInterface dialogInterface, int i) {\r\n                                Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);\r\n                                startActivity(intent);\r\n                            }\r\n                        }).setNegativeButton(\"Go Back\", null).show();\r\n            }\r\n        };\r\n\r\n    }\r\n\r\n    private void askGPSpermission() {\r\n        if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED && ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {\r\n            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {\r\n                requestPermissions(new String[]{Manifest.permission.ACCESS_FINE_LOCATION,Manifest.permission.ACCESS_COARSE_LOCATION,Manifest.permission.INTERNET},10);\r\n            }\r\n            return;\r\n        }\r\n        getUserPosition();\r\n        service.requestLocationUpdates(\"gps\", 500, 1000, locationListener);\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/walktoshop/User/UserView.java	(revision 2d78a7e88b389737403e9628653fe3742669a12b)
+++ app/src/main/java/com/example/walktoshop/User/UserView.java	(date 1612179826023)
@@ -363,7 +363,6 @@
                         }).setNegativeButton("Go Back", null).show();
             }
         };
-
     }
 
     private void askGPSpermission() {
@@ -376,5 +375,4 @@
         getUserPosition();
         service.requestLocationUpdates("gps", 500, 1000, locationListener);
     }
-
 }
Index: app/src/main/res/layout/activity_sellerviewadapter.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<LinearLayout\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\" android:layout_width=\"match_parent\"\r\n    android:layout_height=\"wrap_content\"\r\n    android:orientation=\"vertical\">\r\n\r\n    <androidx.cardview.widget.CardView\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\">\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\">\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"horizontal\">\r\n\r\n                <ImageView\r\n                    android:id=\"@+id/imageView\"\r\n                    android:layout_width=\"100dp\"\r\n                    android:layout_height=\"100dp\"\r\n                    android:src=\"@drawable/sconti\">\r\n                </ImageView>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"210dp\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:orientation=\"vertical\"\r\n                    android:layout_gravity=\"center\">\r\n                    <LinearLayout\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:orientation=\"horizontal\">\r\n                        <TextView\r\n                            android:id=\"@+id/difficulty\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:textStyle=\"bold\"\r\n                           android:textSize=\"20dp\"\r\n                            android:layout_marginVertical=\"8dp\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:text=\"Easy Difficult\" />\r\n\r\n                        <ImageView\r\n                            android:id=\"@+id/difficultyColor\"\r\n                            android:layout_width=\"24dp\"\r\n                            android:layout_height=\"24dp\"\r\n                            android:layout_marginTop=\"1dp\"\r\n                            android:layout_gravity=\"center\"\r\n                            android:src=\"@drawable/ic_green\" />\r\n                    </LinearLayout>\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/disocuntDescription\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:textColor=\"@color/black\"\r\n                        android:textSize=\"17dp\"\r\n                        android:text=\"questa è una entuale descrizione da inserire all'interno dello sconto\">\r\n                    </TextView>\r\n\r\n                </LinearLayout>\r\n                <LinearLayout\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_gravity=\"center\">\r\n                    <ImageButton\r\n                        android:id=\"@+id/arrow\"\r\n                        android:background=\"@color/white\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:src=\"@drawable/ic_navigate_next_black_48dp\">\r\n\r\n                    </ImageButton>\r\n                </LinearLayout>\r\n            </LinearLayout>\r\n            <LinearLayout\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"bottom\">\r\n\r\n                <TextView\r\n                    android:id=\"@+id/date\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_gravity=\"center\"\r\n                    android:layout_marginLeft=\"20dp\"\r\n                    android:layout_marginRight=\"100dp\"\r\n                    android:textStyle=\"bold\"\r\n                    android:textSize=\"15dp\"\r\n                    android:text=\"scadenza: 27/01/2021\"\r\n                    android:textColor=\"@color/black\">\r\n\r\n                </TextView>\r\n\r\n                <Button\r\n                    android:id=\"@+id/addButton\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"@drawable/ovale\"\r\n                    android:visibility=\"visible\"\r\n                    android:textColor=\"@color/white\"\r\n                    android:text=\"AGGIUNGI\">\r\n                </Button>\r\n\r\n                <ImageButton\r\n                    android:id=\"@+id/editDiscount\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"@color/white\"\r\n                    android:layout_marginRight=\"20dp\"\r\n                    android:src=\"@android:drawable/ic_menu_edit\"\r\n                    android:tint=\"@color/verde_maggio\"\r\n                    android:visibility=\"gone\"/>\r\n                <ImageButton\r\n                    android:id=\"@+id/deleteDiscount\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:background=\"@color/white\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginRight=\"20dp\"\r\n                    android:src=\"@android:drawable/ic_menu_delete\"\r\n                    android:tint=\"@color/verde_maggio\"\r\n                    android:visibility=\"gone\"/>\r\n\r\n            </LinearLayout>\r\n\r\n        </LinearLayout>\r\n\r\n    </androidx.cardview.widget.CardView>\r\n\r\n</LinearLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_sellerviewadapter.xml	(revision 2d78a7e88b389737403e9628653fe3742669a12b)
+++ app/src/main/res/layout/activity_sellerviewadapter.xml	(date 1612176437435)
@@ -1,12 +1,15 @@
 <?xml version="1.0" encoding="utf-8"?>
-<LinearLayout
-    xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="match_parent"
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
     android:layout_height="wrap_content"
+    android:backgroundTint="#FFFFFF"
     android:orientation="vertical">
 
     <androidx.cardview.widget.CardView
         android:layout_width="match_parent"
         android:layout_height="wrap_content">
+
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
@@ -21,110 +24,97 @@
                     android:id="@+id/imageView"
                     android:layout_width="100dp"
                     android:layout_height="100dp"
-                    android:src="@drawable/sconti">
-                </ImageView>
+                    android:src="@drawable/sconti"></ImageView>
 
                 <LinearLayout
-                    android:layout_width="210dp"
+                    android:layout_width="wrap_content"
                     android:layout_height="wrap_content"
-                    android:orientation="vertical"
-                    android:layout_gravity="center">
+                    android:orientation="vertical">
+
                     <LinearLayout
                         android:layout_width="wrap_content"
                         android:layout_height="wrap_content"
                         android:orientation="horizontal">
+
                         <TextView
                             android:id="@+id/difficulty"
                             android:layout_width="wrap_content"
                             android:layout_height="wrap_content"
-                            android:textStyle="bold"
-                           android:textSize="20dp"
                             android:layout_marginVertical="8dp"
+                            android:text="Easy Difficult"
                             android:textColor="@color/black"
-                            android:text="Easy Difficult" />
+                            android:textSize="20dp"
+                            android:textStyle="bold" />
 
                         <ImageView
                             android:id="@+id/difficultyColor"
                             android:layout_width="24dp"
                             android:layout_height="24dp"
-                            android:layout_marginTop="1dp"
                             android:layout_gravity="center"
+                            android:layout_marginTop="1dp"
                             android:src="@drawable/ic_green" />
                     </LinearLayout>
 
                     <TextView
                         android:id="@+id/disocuntDescription"
+                        android:layout_width="210dp"
+                        android:layout_height="wrap_content"
+                        android:layout_gravity="center"
+                        android:text="questa è una entuale descrizione da inserire all'interno dello sconto"
+                        android:textColor="@color/black"
+                        android:textSize="17dp"></TextView>
+
+                    <TextView
+                        android:id="@+id/date"
                         android:layout_width="wrap_content"
                         android:layout_height="wrap_content"
+                        android:layout_gravity="right"
+                        android:layout_marginLeft="20dp"
+                        android:text="scadenza: 27/01/2021"
                         android:textColor="@color/black"
-                        android:textSize="17dp"
-                        android:text="questa è una entuale descrizione da inserire all'interno dello sconto">
-                    </TextView>
+                        android:textSize="15dp"
+                        android:textStyle="bold" />
 
                 </LinearLayout>
+
                 <LinearLayout
                     android:layout_width="wrap_content"
                     android:layout_height="wrap_content"
                     android:layout_gravity="center">
+
                     <ImageButton
                         android:id="@+id/arrow"
-                        android:background="@color/white"
                         android:layout_width="wrap_content"
                         android:layout_height="wrap_content"
+                        android:background="@color/white"
                         android:src="@drawable/ic_navigate_next_black_48dp">
 
                     </ImageButton>
                 </LinearLayout>
             </LinearLayout>
-            <LinearLayout
-                android:layout_width="wrap_content"
-                android:layout_height="wrap_content"
-                android:layout_gravity="bottom">
-
-                <TextView
-                    android:id="@+id/date"
-                    android:layout_width="wrap_content"
-                    android:layout_height="wrap_content"
-                    android:layout_gravity="center"
-                    android:layout_marginLeft="20dp"
-                    android:layout_marginRight="100dp"
-                    android:textStyle="bold"
-                    android:textSize="15dp"
-                    android:text="scadenza: 27/01/2021"
-                    android:textColor="@color/black">
 
-                </TextView>
-
-                <Button
-                    android:id="@+id/addButton"
-                    android:layout_width="wrap_content"
-                    android:layout_height="wrap_content"
-                    android:background="@drawable/ovale"
-                    android:visibility="visible"
-                    android:textColor="@color/white"
-                    android:text="AGGIUNGI">
-                </Button>
-
-                <ImageButton
-                    android:id="@+id/editDiscount"
-                    android:layout_width="wrap_content"
-                    android:layout_height="wrap_content"
-                    android:background="@color/white"
-                    android:layout_marginRight="20dp"
-                    android:src="@android:drawable/ic_menu_edit"
-                    android:tint="@color/verde_maggio"
-                    android:visibility="gone"/>
-                <ImageButton
-                    android:id="@+id/deleteDiscount"
-                    android:layout_width="wrap_content"
-                    android:background="@color/white"
-                    android:layout_height="wrap_content"
-                    android:layout_marginRight="20dp"
-                    android:src="@android:drawable/ic_menu_delete"
-                    android:tint="@color/verde_maggio"
-                    android:visibility="gone"/>
+            <ImageButton
+                android:id="@+id/deleteDiscount"
+                android:layout_width="24dp"
+                android:layout_height="24dp"
+                android:layout_gravity="right"
+                android:layout_marginRight="20dp"
+                android:background="@color/white"
+                android:src="@android:drawable/ic_menu_delete"
+                android:tint="@color/verde_maggio"
+                android:visibility="gone" />
 
-            </LinearLayout>
+            <Button
+                android:id="@+id/addButton"
+                android:layout_width="wrap_content"
+                android:layout_height="35dp"
+                android:layout_gravity="center|right"
+                android:background="@color/verde_maggio"
+                android:layout_marginRight="20dp"
+                android:text="aggiungi"
+                android:textColor="@color/white"
+                android:visibility="visible" />
+
 
         </LinearLayout>
 
Index: app/src/main/res/layout/activity_signup.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.coordinatorlayout.widget.CoordinatorLayout\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:padding=\"16dp\"\r\n    android:id=\"@+id/itemPage\"\r\n    android:orientation=\"vertical\"\r\n    android:background=\"@color/white_ice\"\r\n    android:fitsSystemWindows=\"true\">\r\n\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"vertical\">\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\">\r\n            <TextView\r\n                android:id=\"@+id/banner\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"WalkToShop\"\r\n                android:textAlignment=\"center\"\r\n                android:textSize=\"45dp\"\r\n                android:textColor=\"@color/verde_maggio\"\r\n                android:textStyle=\"bold\"\r\n                android:layout_marginTop=\"20dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:fitsSystemWindows=\"true\"/>\r\n\r\n\r\n            <Switch\r\n                android:layout_marginTop=\"20dp\"\r\n                android:id=\"@+id/switch1\"\r\n                android:layout_width=\"139dp\"\r\n                android:layout_height=\"53dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:text=\"Utente\" />\r\n        </LinearLayout>\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\">\r\n\r\n\r\n            <EditText\r\n                android:id=\"@+id/email\"\r\n                android:layout_width=\"317dp\"\r\n                android:layout_height=\"54dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_marginVertical=\"10dp\"\r\n                android:background=\"@drawable/ic_text_box\"\r\n                android:drawableStart=\"@drawable/ic_email\"\r\n                android:drawablePadding=\"4dp\"\r\n                android:elevation=\"6dp\"\r\n                android:ems=\"10\"\r\n                android:hint=\"@string/email\"\r\n                android:inputType=\"textEmailAddress\"\r\n                android:paddingStart=\"6dp\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/password\"\r\n                android:layout_width=\"317dp\"\r\n                android:layout_height=\"54dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:background=\"@drawable/ic_text_box\"\r\n                android:drawableStart=\"@drawable/ic_psw\"\r\n                android:drawablePadding=\"4dp\"\r\n                android:elevation=\"6dp\"\r\n                android:hint=\"Password\"\r\n                android:inputType=\"textPassword\"\r\n                android:paddingStart=\"6dp\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/confermapassword\"\r\n                android:layout_width=\"317dp\"\r\n                android:layout_height=\"54dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_marginVertical=\"10dp\"\r\n                android:background=\"@drawable/ic_text_box\"\r\n                android:drawableStart=\"@drawable/ic_psw\"\r\n                android:drawablePadding=\"4dp\"\r\n                android:elevation=\"6dp\"\r\n                android:hint=\"Conferma password\"\r\n                android:inputType=\"textPassword\"\r\n                android:paddingStart=\"6dp\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/height\"\r\n                android:layout_width=\"317dp\"\r\n                android:layout_height=\"54dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:background=\"@drawable/ic_text_box\"\r\n                android:drawableStart=\"@drawable/ic_height\"\r\n                android:drawablePadding=\"4dp\"\r\n                android:elevation=\"6dp\"\r\n                android:inputType=\"number\"\r\n                android:hint=\"@string/height\"\r\n                android:paddingStart=\"6dp\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/weight\"\r\n                android:layout_width=\"317dp\"\r\n                android:layout_height=\"54dp\"\r\n                android:layout_marginVertical=\"10dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:background=\"@drawable/ic_text_box\"\r\n                android:drawableStart=\"@drawable/ic_balance\"\r\n                android:drawablePadding=\"4dp\"\r\n                android:elevation=\"6dp\"\r\n                android:inputType=\"number\"\r\n                android:hint=\"@string/weight\"\r\n                android:paddingStart=\"6dp\" />\r\n\r\n        </LinearLayout>\r\n\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\">\r\n\r\n            <Button\r\n                android:id=\"@+id/nextButton\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"right\"\r\n                android:layout_marginVertical=\"10dp\"\r\n                android:background=\"@drawable/rounded_button\"\r\n                android:text=\"Avanti\"\r\n                android:textColor=\"@color/white_ice\" />\r\n\r\n            <TextView\r\n                android:id=\"@+id/already_registered\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_gravity=\"center\"\r\n                android:text=\"Sei già registrato? Clicca qui!\"\r\n                android:textColor=\"#7081DF\"\r\n                android:textSize=\"16sp\"\r\n                android:textStyle=\"bold\" />\r\n\r\n\r\n        </LinearLayout>\r\n\r\n    </LinearLayout>\r\n\r\n\r\n\r\n</androidx.coordinatorlayout.widget.CoordinatorLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_signup.xml	(revision 2d78a7e88b389737403e9628653fe3742669a12b)
+++ app/src/main/res/layout/activity_signup.xml	(date 1612172628694)
@@ -24,7 +24,7 @@
                 android:layout_height="wrap_content"
                 android:text="WalkToShop"
                 android:textAlignment="center"
-                android:textSize="45dp"
+                android:textSize="50dp"
                 android:textColor="@color/verde_maggio"
                 android:textStyle="bold"
                 android:layout_marginTop="20dp"
