Index: app/src/main/java/com/example/walktoshop/User/UserView.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.walktoshop.User;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.appcompat.widget.Toolbar;\r\nimport androidx.core.app.ActivityCompat;\r\nimport androidx.core.content.ContextCompat;\r\n\r\nimport android.Manifest;\r\nimport android.app.AlertDialog;\r\nimport android.content.DialogInterface;\r\nimport android.content.Intent;\r\nimport android.content.pm.PackageManager;\r\nimport android.location.Address;\r\nimport android.location.Geocoder;\r\nimport android.location.Location;\r\nimport android.location.LocationListener;\r\nimport android.location.LocationManager;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport android.provider.Settings;\r\nimport android.util.Log;\r\nimport android.view.Menu;\r\nimport android.view.MenuItem;\r\n\r\n\r\nimport com.example.walktoshop.R;\r\n\r\nimport com.example.walktoshop.Seller.Discount;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.android.material.bottomnavigation.BottomNavigationView;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.io.IOException;\r\nimport java.text.BreakIterator;\r\nimport java.util.ArrayList;\r\nimport java.util.Collections;\r\nimport java.util.Iterator;\r\nimport java.util.List;\r\nimport java.util.Locale;\r\n\r\n\r\npublic class UserView extends AppCompatActivity {\r\n    LocationManager service;\r\n    LocationListener locationListener;\r\n    FirebaseFirestore db =FirebaseFirestore.getInstance();\r\n    private boolean statusOfGPS = false;\r\n    double longitude;\r\n    double latitude;\r\n    String city;\r\n    private String userUID=null;\r\n    private ArrayList<Discount> myDiscounts= new ArrayList<>();\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_user_view);\r\n        BottomNavigationView bottomNavigationView = (BottomNavigationView) findViewById(R.id.bottom_navigation);\r\n        bottomNavigationView.setOnNavigationItemSelectedListener(new BottomNavigationView.OnNavigationItemSelectedListener() {\r\n            @Override\r\n            public boolean onNavigationItemSelected(@NonNull MenuItem item) {\r\n                switch (item.getItemId()) {\r\n                    case R.id.action_home:\r\n                        goHome();\r\n                        break;\r\n                    case R.id.action_map:\r\n                        askGPSpermission();\r\n                        break;\r\n                    case R.id.action_statistics:\r\n                        break;\r\n                    case R.id.action_notification:\r\n                        break;\r\n                }\r\n                return true;\r\n            }\r\n        });\r\n        Intent intent =getIntent();\r\n        if(intent.hasExtra(\"UID\")){\r\n            this.userUID = intent.getStringExtra(\"UID\");\r\n        }\r\n    }\r\n\r\n    @Override\r\n    protected void onStart() {\r\n        super.onStart();\r\n        getUserDiscounts();\r\n\r\n    }\r\n    private void getUserDiscounts(){\r\n        db.collection(\"utente\").document(userUID).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n            @Override\r\n            public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                if(task.isSuccessful()){\r\n                    DocumentSnapshot document= task.getResult();\r\n                    ArrayList<String> discountUID = (ArrayList) document.get(\"disocuntUID\");\r\n                    if(discountUID!=null){\r\n                        getMyDiscounts(discountUID);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n    private void getMyDiscounts(ArrayList discountUID){\r\n        Iterator it =discountUID.iterator();\r\n        while(it.hasNext()){\r\n            String uid= (String) it.next();\r\n            db.collection(\"sconti\").document(uid).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n                @Override\r\n                public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                    if(task.isSuccessful()){\r\n                        DocumentSnapshot document= task.getResult();\r\n                        Discount discount=new Discount();\r\n                        discount.setExpiringDate(document.getString(\"expiringDate\"));\r\n                        discount.setBusinessUID(document.getString(\"businessUID\"));\r\n                        discount.setState(document.getString(\"state\"));\r\n                        discount.setDescription(document.getString(\"description\"));\r\n                        discount.setStepNumber(document.getString(\"stepNumber\"));\r\n                        discount.setBusinessUID(document.getString(\"businessUID\"));\r\n                        myDiscounts.add(discount);\r\n                    }\r\n                }\r\n            }).addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n                @Override\r\n                public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                    Log.d(\"myDiscounts\",myDiscounts.get(0).getDescription());\r\n                }\r\n            });\r\n        }\r\n    }\r\n    private void getUserPosition() {\r\n        service = (LocationManager) getSystemService(LOCATION_SERVICE);\r\n        locationListener = new LocationListener() {\r\n            @Override\r\n            public void onLocationChanged(@NonNull Location location) {\r\n                latitude=location.getLatitude();\r\n                longitude=location.getLongitude();\r\n                Log.d(\"coordinates\",latitude+\"\\n\"+longitude);\r\n                try {\r\n                    Geocoder geocoder=new Geocoder(UserView.this);\r\n                    List<Address> addresses=new ArrayList<>();\r\n                    addresses=geocoder.getFromLocation(latitude,longitude,1);\r\n                    String country=addresses.get(0).getCountryName();\r\n                    city=addresses.get(0).getLocality();\r\n                    goToUserViewMap();\r\n                    //Log.d(\"city\",city);\r\n                } catch (IOException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }\r\n\r\n            @Override\r\n            public void onProviderEnabled(@NonNull String provider) {\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onProviderDisabled(@NonNull String provider) {\r\n                new AlertDialog.Builder(UserView.this).setTitle(\"GPS dialog\").setMessage(\"Do you want to turn on gps?\")\r\n                        .setPositiveButton(\"Yes\", new DialogInterface.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(DialogInterface dialogInterface, int i) {\r\n                                Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);\r\n                                startActivity(intent);\r\n                            }\r\n                        }).setNegativeButton(\"Go Back\", null).show();\r\n            }\r\n        };\r\n\r\n    }\r\n\r\n    private void askGPSpermission() {\r\n        if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED && ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {\r\n            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {\r\n                requestPermissions(new String[]{Manifest.permission.ACCESS_FINE_LOCATION,Manifest.permission.ACCESS_COARSE_LOCATION,Manifest.permission.INTERNET},10);\r\n            }\r\n            return;\r\n        }\r\n        getUserPosition();\r\n        service.requestLocationUpdates(\"gps\", 500, 1000, locationListener);\r\n    }\r\n\r\n    @Override\r\n    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\r\n        super.onRequestPermissionsResult(requestCode, permissions, grantResults);\r\n        switch(requestCode){\r\n            case 10:\r\n                if(grantResults.length>0 && grantResults[0]==PackageManager.PERMISSION_GRANTED){\r\n\r\n                }else if(grantResults[0]==PackageManager.PERMISSION_DENIED){\r\n                    if(ActivityCompat.shouldShowRequestPermissionRationale(UserView.this,Manifest.permission.ACCESS_FINE_LOCATION)){\r\n                        //dialog in cui spiego\r\n                        new AlertDialog.Builder(UserView.this)\r\n                                .setTitle(\"Permission\")\r\n                                .setMessage(\"Denying permission you can't use geo-localization\")\r\n                                .setNeutralButton(\"ok\",null)\r\n                                .show();\r\n                    }\r\n                }\r\n                return;\r\n        }\r\n    }\r\n\r\n    private void goToUserViewMap() {\r\n        final Intent intent = new Intent(UserView.this, UserMapView.class);\r\n        intent.putExtra(\"latitude\", latitude);\r\n        intent.putExtra(\"longitude\", longitude);\r\n        intent.putExtra(\"city\", city );\r\n        startActivity(intent);\r\n\r\n    }\r\n\r\n    public void goHome() {\r\n        final Intent intent = new Intent(this, UserView.class);\r\n        startActivity(intent);\r\n    }\r\n\r\n    public boolean onCreateOptionsMenu(Menu menu){\r\n        getMenuInflater().inflate(R.menu.menu_action_bar, menu);\r\n        return true;\r\n    }\r\n\r\n    public boolean onOptionsItemSelected(MenuItem item){\r\n        return super.onOptionsItemSelected(item);\r\n    }\r\n    public void OnItemSelected(MenuItem item) {\r\n        switch (item.getItemId()){\r\n            case R.id.action_search:\r\n                break;\r\n            case R.id.action_exit:\r\n                break;\r\n            case R.id.action_settings:\r\n                break;\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/walktoshop/User/UserView.java	(revision 7b60eb0ed91cee5e193ee06d0023ff65e2da5d94)
+++ app/src/main/java/com/example/walktoshop/User/UserView.java	(date 1611157073057)
@@ -22,11 +22,14 @@
 import android.util.Log;
 import android.view.Menu;
 import android.view.MenuItem;
+import android.widget.ListView;
 
 
 import com.example.walktoshop.R;
 
 import com.example.walktoshop.Seller.Discount;
+import com.example.walktoshop.Seller.SellerView;
+import com.example.walktoshop.Seller.SellerViewAdapter;
 import com.google.android.gms.tasks.OnCompleteListener;
 import com.google.android.gms.tasks.Task;
 import com.google.android.material.bottomnavigation.BottomNavigationView;
@@ -46,6 +49,7 @@
     LocationManager service;
     LocationListener locationListener;
     FirebaseFirestore db =FirebaseFirestore.getInstance();
+    private ListView homeListView;
     private boolean statusOfGPS = false;
     double longitude;
     double latitude;
@@ -56,6 +60,7 @@
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.activity_user_view);
+        homeListView=findViewById(R.id.homeListView);
         BottomNavigationView bottomNavigationView = (BottomNavigationView) findViewById(R.id.bottom_navigation);
         bottomNavigationView.setOnNavigationItemSelectedListener(new BottomNavigationView.OnNavigationItemSelectedListener() {
             @Override
@@ -123,7 +128,8 @@
             }).addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                 @Override
                 public void onComplete(@NonNull Task<DocumentSnapshot> task) {
-                    Log.d("myDiscounts",myDiscounts.get(0).getDescription());
+                    //final SellerViewAdapter adapter=new SellerViewAdapter(UserView.this,myDiscounts, userUID,null,"userHome");
+                    //homeListView.setAdapter(adapter);
                 }
             });
         }
Index: app/src/main/res/layout/activity_user_view.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<androidx.coordinatorlayout.widget.CoordinatorLayout\r\nxmlns:android=\"http://schemas.android.com/apk/res/android\"\r\nxmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\nxmlns:tools=\"http://schemas.android.com/tools\"\r\nandroid:layout_width=\"match_parent\"\r\nandroid:layout_height=\"match_parent\">\r\n\r\n<ProgressBar\r\n    android:id=\"@+id/sellerViewProgressBar\"\r\n    style=\"?android:attr/progressBarStyle\"\r\n    android:layout_width=\"91dp\"\r\n    android:layout_height=\"81dp\"\r\n    android:layout_marginLeft=\"160dp\"\r\n    android:layout_marginTop=\"350dp\"\r\n    android:visibility=\"gone\"/>\r\n\r\n\r\n<androidx.cardview.widget.CardView\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:layout_margin=\"8dp\"\r\n    android:id=\"@+id/card\">\r\n\r\n\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"vertical\">\r\n\r\n        <ImageView\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"194dp\"\r\n            app:srcCompat=\"@drawable/feltrinelli\"/>\r\n\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\"\r\n            android:padding=\"16dp\">\r\n\r\n            <TextView\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"La Mia Attività\"\r\n                android:textAppearance=\"?attr/textAppearanceHeadline4\"/>\r\n\r\n            <TextView\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:text=\"Sconti Attivi\"\r\n                android:textAppearance=\"?attr/textAppearanceHeadline5\"/>\r\n\r\n\r\n\r\n        </LinearLayout>\r\n\r\n\r\n\r\n    </LinearLayout>\r\n\r\n</androidx.cardview.widget.CardView>\r\n\r\n<com.google.android.material.floatingactionbutton.FloatingActionButton\r\n    android:id=\"@+id/fab\"\r\n    android:layout_width=\"wrap_content\"\r\n    android:layout_height=\"wrap_content\"\r\n    android:layout_gravity=\"bottom|right\"\r\n    android:layout_marginRight=\"@dimen/material_bottom_margin\"\r\n    android:layout_marginBottom=\"@dimen/material_botton_margin\"\r\n    android:src=\"@drawable/baseline_add_black_18dp\"\r\n    app:backgroundTint=\"@color/verde_maggio\"\r\n    app:backgroundTintMode=\"src_over\"\r\n    app:fabSize=\"normal\"\r\n    app:rippleColor=\"#00FF00\" />\r\n    <com.google.android.material.bottomnavigation.BottomNavigationView\r\n        android:id=\"@+id/bottom_navigation\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_gravity=\"bottom\"\r\n        style=\"@style/Widget.MaterialComponents.BottomNavigationView.Colored\"\r\n        app:menu=\"@menu/menu_bottom_navigation_view\"/>\r\n\r\n</androidx.coordinatorlayout.widget.CoordinatorLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_user_view.xml	(revision 7b60eb0ed91cee5e193ee06d0023ff65e2da5d94)
+++ app/src/main/res/layout/activity_user_view.xml	(date 1611157073063)
@@ -52,15 +52,19 @@
                 android:layout_marginTop="8dp"
                 android:text="Sconti Attivi"
                 android:textAppearance="?attr/textAppearanceHeadline5"/>
-
-
-
         </LinearLayout>
-
+        <LinearLayout
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:orientation="vertical">
+            <ListView
+                android:id="@+id/homeListView"
+                android:layout_width="match_parent"
+                android:layout_height="370dp">
 
-
+            </ListView>
+        </LinearLayout>
     </LinearLayout>
-
 </androidx.cardview.widget.CardView>
 
 <com.google.android.material.floatingactionbutton.FloatingActionButton
Index: app/src/main/java/com/example/walktoshop/Seller/SellerView.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.walktoshop.Seller;\r\n\r\nimport android.app.AlertDialog;\r\nimport android.content.DialogInterface;\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.Menu;\r\nimport android.view.MenuItem;\r\nimport android.view.View;\r\nimport android.widget.AdapterView;\r\nimport android.widget.Button;\r\nimport android.widget.ListView;\r\nimport android.widget.ProgressBar;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.coordinatorlayout.widget.CoordinatorLayout;\r\nimport androidx.fragment.app.FragmentManager;\r\nimport androidx.fragment.app.FragmentTransaction;\r\n\r\nimport com.example.walktoshop.Login_SignUp.Fragment_SignUp;\r\nimport com.example.walktoshop.R;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.android.material.floatingactionbutton.FloatingActionButton;\r\nimport com.google.android.material.snackbar.BaseTransientBottomBar;\r\nimport com.google.android.material.snackbar.Snackbar;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.util.ArrayList;\r\n\r\npublic class SellerView extends AppCompatActivity {\r\n    private ListView listView;\r\n    private String UID=null;\r\n    private ProgressBar progressBar;\r\n    private Button addActivityButton;\r\n    FirebaseFirestore db =FirebaseFirestore.getInstance();\r\n    private ArrayList<Discount> discountArray=new ArrayList<>();\r\n    private ArrayList<String> businessUID =new ArrayList<>();\r\n    private ArrayList<String> discountUID = new ArrayList<>();\r\n    private FloatingActionButton mFab;\r\n    @Override\r\n    protected void onCreate(@Nullable Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_seller_view);\r\n        //View coordinatorLayout = findViewById(android.R.id.content);\r\n        addActivityButton=(Button)findViewById(R.id.addActivityButton);\r\n        addActivityButton.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                goSellerMapView();\r\n                addActivityButton.setVisibility(View.INVISIBLE);\r\n            }\r\n        });\r\n        mFab = (FloatingActionButton) findViewById(R.id.fab);\r\n        mFab.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                startManageDiscount();\r\n            }\r\n        });\r\n        progressBar=findViewById(R.id.sellerViewProgressBar);\r\n        listView=findViewById(R.id.listView);\r\n        Intent intent = getIntent();\r\n        if(intent.hasExtra(\"UID\")){\r\n            UID=intent.getStringExtra(\"UID\");\r\n        }\r\n    }\r\n\r\n    @Override\r\n    protected void onStart() {\r\n        super.onStart();\r\n        getSellerBusinessUID();\r\n        if(discountUID==null){\r\n            addActivityButton.setVisibility(View.INVISIBLE);\r\n        }else if(discountUID.isEmpty()){\r\n            Log.d(\"bi\",discountUID.toString());\r\n            addActivityButton.setVisibility(View.INVISIBLE);\r\n        }else\r\n        {\r\n            //editext con su scritto non hai alcuno sconto disponibile\r\n        }\r\n    }\r\n\r\n\r\n    public boolean onCreateOptionsMenu(Menu menu){\r\n        getMenuInflater().inflate(R.menu.menu_action_bar, menu);\r\n        return true;\r\n    }\r\n\r\n    public boolean onOptionsItemSelected(MenuItem item){\r\n        return super.onOptionsItemSelected(item);\r\n    }\r\n    public void OnItemSelected(MenuItem item) {\r\n        switch (item.getItemId()){\r\n            case R.id.action_search:\r\n                break;\r\n            case R.id.action_exit:\r\n                break;\r\n            case R.id.action_settings:\r\n                break;\r\n        }\r\n    }\r\n\r\n    private void getSellerBusinessUID(){\r\n        if(UID!=null){\r\n            db.collection(\"venditore\").document(this.UID).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n                @Override\r\n                public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                    if(task.isSuccessful()){\r\n                        DocumentSnapshot document= task.getResult();\r\n                        businessUID= (ArrayList) document.get(\"businessUID\");\r\n                        //se ha delle attività le recupera\r\n                        Log.d(\"businessUID\",businessUID.toString());\r\n                        if(businessUID.size()>0 && businessUID!=null && !businessUID.isEmpty()){\r\n                            progressBar.setVisibility(View.VISIBLE);\r\n                            getBusiness();\r\n                            progressBar.setVisibility(View.INVISIBLE);\r\n                        }else{\r\n                            addActivityButton.setVisibility(View.VISIBLE);\r\n                            progressBar.setVisibility(View.INVISIBLE);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n    private void getBusiness(){\r\n        if(businessUID!=null && !businessUID.isEmpty()){\r\n            for(int i=0;i<businessUID.size();i++){\r\n                String b=businessUID.get(i);\r\n                Log.d(\"b\",b);\r\n                db.collection(\"attivita\").document(b).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n                    @Override\r\n                    public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                        if(task.isSuccessful()){\r\n                            DocumentSnapshot document= task.getResult();\r\n                            if (document.exists()) {\r\n                                //Log.d(\"TAG\", \"DocumentSnapshot data: \" + document.getData());\r\n                                discountUID=(ArrayList) document.get(\"discountUID\");\r\n                                //Log.d(\"TAG\", \"uid dello sconto\" + discountUID.toString());\r\n                                if(discountUID!=null && !discountUID.isEmpty()){\r\n                                    getDiscounts();\r\n                                }else{\r\n                                    final SellerViewAdapter adapter=new SellerViewAdapter(SellerView.this,discountArray, UID,businessUID);\r\n                                    listView.setAdapter(adapter);\r\n                                }\r\n                            } else {\r\n                                Log.d(\"TAG\", \"No such document\");\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n    }\r\n    private void getDiscounts(){\r\n        discountArray.clear();\r\n            for(int k=0;k<discountUID.size();k++){\r\n                db.collection(\"sconti\").document(discountUID.get(k)).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n                    @Override\r\n                    public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                        if(task.isSuccessful()){\r\n                            Discount discount=new Discount();\r\n                            DocumentSnapshot document=task.getResult();\r\n                            discount.setUID(document.getString(\"uid\"));\r\n                            discount.setBusinessUID(document.getString(\"businessUID\"));\r\n                            discount.setState(document.getString(\"state\"));\r\n                            discount.setExpiringDate(document.getString(\"expiringDate\"));\r\n                            discount.setStepNumber(document.getString(\"stepNumber\"));\r\n                            discount.setPercentage(document.getString(\"percentage\"));\r\n                            discount.setDescription(document.getString(\"description\"));\r\n                            discount.setDiscountsQuantity(document.getString(\"discountsQuantity\"));\r\n                            discountArray.add(discount);\r\n                        }\r\n                    }\r\n                }).addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n                    @Override\r\n                    public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                        for(int i=0;i<discountArray.size();i++){\r\n                            Log.d(\"array\",discountArray.get(i).getDescription()+\" \");\r\n                        }\r\n                        final SellerViewAdapter adapter=new SellerViewAdapter(SellerView.this,discountArray, UID,businessUID);\r\n                        listView.setAdapter(adapter);\r\n                    }\r\n                });\r\n            }\r\n    }\r\n    private void dialog(){\r\n        AlertDialog.Builder builder = new AlertDialog.Builder(this);\r\n        // Add the buttons\r\n        builder.setPositiveButton(R.string.yes, new DialogInterface.OnClickListener() {\r\n            public void onClick(DialogInterface dialog, int id) {\r\n                // User clicked OK button\r\n                goSellerMapView();\r\n\r\n            }\r\n        }).setNegativeButton(R.string.no, new DialogInterface.OnClickListener() {\r\n            public void onClick(DialogInterface dialog, int id) {\r\n                // User cancelled the dialog\r\n            }\r\n        }).setMessage(R.string.emptyBusiness);\r\n        // Set other d\r\n        builder.show();\r\n    }\r\n    private void goSellerMapView(){\r\n        final Intent intent = new Intent(this, SellerMapView.class);\r\n        intent.putExtra(\"UID\",UID);\r\n        startActivity(intent);\r\n    }\r\n    private void startManageDiscount(){\r\n        final Intent intent = new Intent(this, ManageDiscount.class);\r\n        intent.putExtra(\"businessUID\",businessUID.get(0));\r\n        //Log.d(\"u\",businessUID.get(0).toString());\r\n        startActivity(intent);\r\n    }\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/walktoshop/Seller/SellerView.java	(revision 7b60eb0ed91cee5e193ee06d0023ff65e2da5d94)
+++ app/src/main/java/com/example/walktoshop/Seller/SellerView.java	(date 1611155402190)
@@ -146,7 +146,7 @@
                                 if(discountUID!=null && !discountUID.isEmpty()){
                                     getDiscounts();
                                 }else{
-                                    final SellerViewAdapter adapter=new SellerViewAdapter(SellerView.this,discountArray, UID,businessUID);
+                                    final SellerViewAdapter adapter=new SellerViewAdapter(SellerView.this,discountArray, UID,businessUID,"sellerHome");
                                     listView.setAdapter(adapter);
                                 }
                             } else {
@@ -185,7 +185,7 @@
                         for(int i=0;i<discountArray.size();i++){
                             Log.d("array",discountArray.get(i).getDescription()+" ");
                         }
-                        final SellerViewAdapter adapter=new SellerViewAdapter(SellerView.this,discountArray, UID,businessUID);
+                        final SellerViewAdapter adapter=new SellerViewAdapter(SellerView.this,discountArray, UID,businessUID,"sellerHome");
                         listView.setAdapter(adapter);
                     }
                 });
Index: app/src/main/java/com/example/walktoshop/Seller/SellerViewAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.walktoshop.Seller;\r\n\r\nimport android.app.AlertDialog;\r\nimport android.content.Context;\r\nimport android.content.DialogInterface;\r\nimport android.content.Intent;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.ArrayAdapter;\r\nimport android.widget.Button;\r\nimport android.widget.ImageView;\r\nimport android.widget.ListView;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\n\r\nimport com.example.walktoshop.R;\r\nimport com.example.walktoshop.Seller.Business;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.OnFailureListener;\r\nimport com.google.android.gms.tasks.OnSuccessListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.firestore.DocumentReference;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FieldValue;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.lang.reflect.Field;\r\nimport java.util.ArrayList;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\n\r\npublic class SellerViewAdapter extends ArrayAdapter {\r\n    private Context context;\r\n    private ArrayList<Discount> discounts;\r\n    private String UID;\r\n    private ArrayList<String> businessUID;\r\n    FirebaseFirestore db =FirebaseFirestore.getInstance();\r\n\r\n\r\n    public SellerViewAdapter(Context context, ArrayList<Discount> discounts, String UID,ArrayList businessUID) {\r\n        super(context, R.layout.activity_sellerviewadapter);\r\n        this.context=context;\r\n        this.discounts=discounts;\r\n        this.UID = UID;\r\n        this.businessUID = businessUID;\r\n    }\r\n    @Override\r\n    public int getCount() {\r\n        return discounts.size();\r\n    }\r\n    @Override\r\n    public Object getItem(int position) {\r\n        return discounts.get(position);\r\n    }\r\n\r\n    @Override\r\n    public long getItemId(int position) {\r\n        return position;\r\n    }\r\n    @Override\r\n    public int getViewTypeCount() {\r\n        if(getCount() > 0){\r\n            return getCount();\r\n        }else{\r\n            return super.getViewTypeCount();\r\n        }\r\n    }\r\n    @Override\r\n    public int getItemViewType(int position) {\r\n        return position;\r\n    }\r\n\r\n    @NonNull\r\n    @Override\r\n    public View getView(int position, @Nullable View convertView, @NonNull ViewGroup parent) {\r\n        LayoutInflater layoutInflater=(LayoutInflater) context.getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);\r\n        final View activity_business = layoutInflater.inflate(R.layout.activity_sellerviewadapter,parent,false);\r\n        //caratteristiche card di sconto\r\n        TextView myTitle = activity_business.findViewById(R.id.text);\r\n\r\n        TextView myDescription = activity_business.findViewById(R.id.description);\r\n        //bottone eliminazione\r\n        Button deletebusiness = activity_business.findViewById(R.id.deletebusiness);\r\n        //bottone attivazione contapassi\r\n\r\n        //bottone abilitazione\r\n\r\n        if(this.discounts.get(position) != null && position>=0 && !discounts.isEmpty()){\r\n            Discount d=this.discounts.get(position);\r\n            Log.d(\"nome\",discounts.get(position).getDescription() + position);\r\n            myTitle.setText(d.getDescription());\r\n            myDescription.setText(\"vuota\");\r\n            deletebusiness.setOnClickListener(new View.OnClickListener() {\r\n                @Override\r\n                public void onClick(View v) {\r\n                    Log.d(\"p\",discounts.get(position).getUID()+\" \");\r\n                        getBusiness(position);\r\n                }\r\n            });\r\n        }else{\r\n            Log.d(\"else\",\"else\");\r\n        }\r\n        return activity_business;\r\n    }\r\n\r\n    private void deleteDiscount(int position){\r\n        //getBusiness(position);\r\n        db.collection(\"sconti\").document(discounts.get(position).getUID())\r\n                .delete()\r\n                .addOnSuccessListener(new OnSuccessListener<Void>() {\r\n                    @Override\r\n                    public void onSuccess(Void aVoid) {\r\n                        Log.d(\"delete\", \"DocumentSnapshot successfully deleted!\");\r\n                    }\r\n                })\r\n                .addOnFailureListener(new OnFailureListener() {\r\n                    @Override\r\n                    public void onFailure(@NonNull Exception e) {\r\n                        Log.w(\"delete\", \"Error deleting document\", e);\r\n                    }\r\n                }).addOnCompleteListener(new OnCompleteListener<Void>() {\r\n            @Override\r\n            public void onComplete(@NonNull Task<Void> task) {\r\n                SellerViewAdapter.this.discounts.remove(position);\r\n                SellerViewAdapter.this.notifyDataSetChanged();\r\n            }\r\n        });\r\n    }\r\n\r\n    private void getBusiness(int position)\r\n    {\r\n        db.collection(\"attivita\").document(businessUID.get(0)).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {\r\n            @Override\r\n            public void onComplete(@NonNull Task<DocumentSnapshot> task) {\r\n                if(task.isSuccessful())\r\n                {   Log.d(\"position\",position+\" \");\r\n                    DocumentSnapshot document = task.getResult();\r\n                    ArrayList<String> discountUID = (ArrayList<String>) document.get(\"discountUID\");\r\n                    discountUID.remove(position);\r\n                    Log.d(\"disocuntUID\", discountUID.size()+\" \");\r\n                    updateBusiness(discountUID,position);\r\n                }else{\r\n                    Log.d(\"non successo\",\"non successo\");\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    private void updateBusiness(ArrayList<String> discountUID,int position)\r\n    {\r\n        db.collection(\"attivita\").document(businessUID.get(0)).update(\"discountUID\",discountUID).addOnCompleteListener(new OnCompleteListener<Void>() {\r\n            @Override\r\n            public void onComplete(@NonNull Task<Void> task) {\r\n                if(task.isSuccessful())\r\n                {\r\n                    deleteDiscount(position);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/walktoshop/Seller/SellerViewAdapter.java	(revision 7b60eb0ed91cee5e193ee06d0023ff65e2da5d94)
+++ app/src/main/java/com/example/walktoshop/Seller/SellerViewAdapter.java	(date 1611155402197)
@@ -39,14 +39,16 @@
     private ArrayList<Discount> discounts;
     private String UID;
     private ArrayList<String> businessUID;
+    private String usage;
     FirebaseFirestore db =FirebaseFirestore.getInstance();
 
 
-    public SellerViewAdapter(Context context, ArrayList<Discount> discounts, String UID,ArrayList businessUID) {
+    public SellerViewAdapter(Context context, ArrayList<Discount> discounts, String UID,ArrayList businessUID,String usage) {
         super(context, R.layout.activity_sellerviewadapter);
         this.context=context;
         this.discounts=discounts;
         this.UID = UID;
+        this.usage= usage;
         this.businessUID = businessUID;
     }
     @Override
@@ -95,15 +97,17 @@
             Log.d("nome",discounts.get(position).getDescription() + position);
             myTitle.setText(d.getDescription());
             myDescription.setText("vuota");
-            deletebusiness.setOnClickListener(new View.OnClickListener() {
-                @Override
-                public void onClick(View v) {
-                    Log.d("p",discounts.get(position).getUID()+" ");
+            deletebusiness.setVisibility(View.GONE);
+            if(this.usage=="sellerHome"){
+                deletebusiness.setVisibility(View.VISIBLE);
+                deletebusiness.setOnClickListener(new View.OnClickListener() {
+                    @Override
+                    public void onClick(View v) {
+                        Log.d("p",discounts.get(position).getUID()+" ");
                         getBusiness(position);
-                }
-            });
-        }else{
-            Log.d("else","else");
+                    }
+                });
+            }
         }
         return activity_business;
     }
